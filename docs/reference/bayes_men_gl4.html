<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Bayesian test for segregation distortion in tetraploids using genotype likelihoods — bayes_men_gl4 • menbayes</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian test for segregation distortion in tetraploids using genotype likelihoods — bayes_men_gl4"><meta property="og:description" content="This will run a Bayesian ratio test using the genotypes of an F1 population
of tetraploids for the null of Mendelian segregation (accounting for double
reduction and preferential pairing) against the alternative of
segregation distortion. This is when genotype uncertainty is accounted
for through genotype likelihoods."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">menbayes</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/intro.html">Introduction to menbayes</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dcgerard/menbayes/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Bayesian test for segregation distortion in tetraploids using genotype likelihoods</h1>
    <small class="dont-index">Source: <a href="https://github.com/dcgerard/menbayes/blob/HEAD/R/glpknown.R" class="external-link"><code>R/glpknown.R</code></a></small>
    <div class="hidden name"><code>bayes_men_gl4.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This will run a Bayesian ratio test using the genotypes of an F1 population
of tetraploids for the null of Mendelian segregation (accounting for double
reduction and preferential pairing) against the alternative of
segregation distortion. This is when genotype uncertainty is accounted
for through genotype likelihoods.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bayes_men_gl4</span><span class="op">(</span></span>
<span>  <span class="va">gl</span>,</span>
<span>  g1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  g2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  drbound <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">6</span>,</span>
<span>  shape1 <span class="op">=</span> <span class="fl">5</span><span class="op">/</span><span class="fl">9</span>,</span>
<span>  shape2 <span class="op">=</span> <span class="fl">10</span><span class="op">/</span><span class="fl">9</span>,</span>
<span>  ts1 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  ts2 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pp <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  xi1 <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>  xi2 <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>  parent_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"est"</span>, <span class="st">"marg"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>gl</dt>
<dd><p>The genotype log-likelihoods. The rows index the individuals
and the columns index the genotypes.</p></dd>


<dt>g1</dt>
<dd><p>Either parent 1's genotype, or parent 1's genotype log-likelihoods.</p></dd>


<dt>g2</dt>
<dd><p>Either parent 2's genotype, or parent 2's genotype log-likelihoods.</p></dd>


<dt>drbound</dt>
<dd><p>The maximum rate of double reduction. A default of 1/6
is provided, which is the rate under the complete equational
segregation model of meiosis.</p></dd>


<dt>shape1</dt>
<dd><p>The shape 1 parameter for the beta prior over the
preferential pairing parameter.</p></dd>


<dt>shape2</dt>
<dd><p>The shape 2 parameter for the beta prior over the
preferential pairing parameter.</p></dd>


<dt>ts1</dt>
<dd><p>The shape 1 parameter for the beta prior over the
rate of quadrivalent formation.</p></dd>


<dt>ts2</dt>
<dd><p>The shape 2 parameter for the beta prior over the
rate of quadrivalent formation.</p></dd>


<dt>pp</dt>
<dd><p>A logical. Should we account for preferential pairing
(<code>TRUE</code>) or not (<code>FALSE</code>)?</p></dd>


<dt>dr</dt>
<dd><p>A logical. Should we account for double reduction
(<code>TRUE</code>) or not (<code>FALSE</code>)?</p></dd>


<dt>alpha</dt>
<dd><p>If <code>dr = FALSE</code>, then <code>alpha</code> is the known rate of
double reduction (assumed fixed).</p></dd>


<dt>xi1</dt>
<dd><p>If <code>pp = FALSE</code>, then <code>xi</code> is the known rate of
preferential pairing (assumed fixed) of parent 1.</p></dd>


<dt>xi2</dt>
<dd><p>If <code>pp = FALSE</code>, then <code>xi</code> is the known rate of
preferential pairing (assumed fixed) of parent 2.</p></dd>


<dt>parent_method</dt>
<dd><p>If unknown, should we estimate the parent genotypes
by maximum likelihood (<code>"est"</code>) or marginalize over them
(<code>"marg"</code>)?</p></dd>


<dt>...</dt>
<dd><p>Additional arguments to pass to Stan.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list with the following elements</p><dl><dt><code>lbf</code></dt>
<dd><p>The log Bayes Factor.</p></dd>

<dt><code>m0</code></dt>
<dd><p>Marginal likelihood under null.</p></dd>

<dt><code>ma</code></dt>
<dd><p>Marginal likelihood under alternative.</p></dd>

<dt><code>alpha</code></dt>
<dd><p>The posterior mean double reduction rate.</p></dd>

<dt><code>xi1</code></dt>
<dd><p>The posterior mean preferential pairing parameter of parent 1.</p></dd>

<dt><code>xi2</code></dt>
<dd><p>The posterior mean preferential pairing parameter of parent 2.</p></dd>


</dl></div>
    <div id="unidentified-parameters">
    <h2>Unidentified parameters</h2>
    

<p>When <code>g1 = 2</code> or <code>g2 = 2</code> (or both), the model is not identified
and those estimates (<code>alpha</code>, <code>xi1</code>, and <code>xi2</code>) are
meaningless. Do NOT interpret them.</p>
<p>The estimate of <code>alpha</code> (double reduction rate) IS identified as
long as at least one parent is simplex, and no parent is duplex.
However, the estimates of the double reduction rate have extremely high
variance.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>David Gerard</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">## null sims</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">g1</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">g2</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">gl</span> <span class="op">&lt;-</span> <span class="fu"><a href="simf1gl.html">simf1gl</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, g1 <span class="op">=</span> <span class="va">g1</span>, g2 <span class="op">=</span> <span class="va">g2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">bayes_men_gl4</span><span class="op">(</span>gl <span class="op">=</span> <span class="va">gl</span>, g1 <span class="op">=</span> <span class="va">g1</span>, g2 <span class="op">=</span> <span class="va">g2</span>, chains <span class="op">=</span> <span class="fl">1</span>, iter <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## genotypes of parents not known</span></span></span>
<span class="r-in"><span><span class="fu">bayes_men_gl4</span><span class="op">(</span>gl <span class="op">=</span> <span class="va">gl</span>, chains <span class="op">=</span> <span class="fl">1</span>, iter <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## alt sims</span></span></span>
<span class="r-in"><span><span class="va">gl</span> <span class="op">&lt;-</span> <span class="fu">hwep</span><span class="fu">::</span><span class="fu"><a href="https://dcgerard.github.io/hwep/reference/simgl.html" class="external-link">simgl</a></span><span class="op">(</span>nvec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>, rdepth <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">bayes_men_gl4</span><span class="op">(</span>gl <span class="op">=</span> <span class="va">gl</span>, g1 <span class="op">=</span> <span class="va">g1</span>, g2 <span class="op">=</span> <span class="va">g2</span>, chains <span class="op">=</span> <span class="fl">1</span>, iter <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">bayes_men_gl4</span><span class="op">(</span>gl <span class="op">=</span> <span class="va">gl</span>, chains <span class="op">=</span> <span class="fl">1</span>, iter <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by David Gerard, Mira Thakkar, NSF DBI 2132247.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

